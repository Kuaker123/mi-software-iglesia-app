# Generated by Django 4.2.16 on 2025-07-18 06:01

from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    dependencies = [
        ('core', '0004_alter_contribucion_metodo_pago_and_more'),
    ]

    operations = [
        migrations.CreateModel(
            name='ConfiguracionComunicacion',
            fields=[
                ('id_config', models.AutoField(primary_key=True, serialize=False)),
                ('servidor_smtp', models.CharField(default='smtp.gmail.com', max_length=100)),
                ('puerto_smtp', models.IntegerField(default=587)),
                ('usar_tls', models.BooleanField(default=True)),
                ('email_remitente', models.EmailField(max_length=254)),
                ('nombre_remitente', models.CharField(default='Iglesia', max_length=100)),
                ('usuario_smtp', models.CharField(max_length=100)),
                ('password_smtp', models.CharField(help_text='Se recomienda usar variables de entorno', max_length=100)),
                ('max_intentos_envio', models.IntegerField(default=3)),
                ('intervalo_entre_envios', models.IntegerField(default=1, help_text='Segundos entre envíos')),
                ('max_destinatarios_por_lote', models.IntegerField(default=50)),
                ('notificaciones_activas', models.BooleanField(default=True)),
                ('dias_mantener_notificaciones', models.IntegerField(default=30)),
                ('habilitar_seguimiento_lectura', models.BooleanField(default=True)),
                ('habilitar_seguimiento_clicks', models.BooleanField(default=True)),
                ('activa', models.BooleanField(default=True)),
                ('fecha_creacion', models.DateTimeField(auto_now_add=True)),
                ('fecha_modificacion', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Configuración de Comunicación',
                'verbose_name_plural': 'Configuraciones de Comunicación',
                'db_table': 'Configuracion_Comunicacion',
            },
        ),
        migrations.CreateModel(
            name='ListaDistribucion',
            fields=[
                ('id_lista', models.AutoField(primary_key=True, serialize=False)),
                ('nombre', models.CharField(max_length=100, unique=True)),
                ('descripcion', models.TextField(blank=True, null=True)),
                ('tipo', models.CharField(choices=[('general', 'General'), ('grupo', 'Por Grupo'), ('ministerio', 'Por Ministerio'), ('evento', 'Por Evento'), ('personalizada', 'Personalizada')], default='general', max_length=50)),
                ('activa', models.BooleanField(default=True)),
                ('fecha_creacion', models.DateTimeField(auto_now_add=True)),
                ('creado_por', models.CharField(blank=True, max_length=100, null=True)),
                ('incluir_solo_activos', models.BooleanField(default=True)),
                ('incluir_solo_con_email', models.BooleanField(default=True)),
                ('incluir_grupos', models.ManyToManyField(blank=True, related_name='listas_distribucion', to='core.grupo')),
            ],
            options={
                'verbose_name': 'Lista de Distribución',
                'verbose_name_plural': 'Listas de Distribución',
                'db_table': 'Listas_Distribucion',
            },
        ),
        migrations.CreateModel(
            name='Mensaje',
            fields=[
                ('id_mensaje', models.AutoField(primary_key=True, serialize=False)),
                ('titulo', models.CharField(max_length=200)),
                ('contenido', models.TextField()),
                ('tipo', models.CharField(choices=[('email', 'Correo Electrónico'), ('notificacion', 'Notificación Interna'), ('anuncio', 'Anuncio General'), ('recordatorio', 'Recordatorio')], default='email', max_length=50)),
                ('fecha_programada', models.DateTimeField(blank=True, help_text='Dejar vacío para envío inmediato', null=True)),
                ('fecha_envio', models.DateTimeField(blank=True, null=True)),
                ('estado', models.CharField(choices=[('borrador', 'Borrador'), ('programado', 'Programado'), ('enviando', 'Enviando'), ('enviado', 'Enviado'), ('error', 'Error'), ('cancelado', 'Cancelado')], default='borrador', max_length=50)),
                ('asunto_email', models.CharField(blank=True, max_length=200, null=True)),
                ('es_html', models.BooleanField(default=True)),
                ('adjuntos', models.JSONField(default=list, help_text='Lista de rutas de archivos adjuntos')),
                ('prioridad', models.CharField(choices=[('baja', 'Baja'), ('normal', 'Normal'), ('alta', 'Alta'), ('urgente', 'Urgente')], default='normal', max_length=20)),
                ('creado_por', models.CharField(max_length=100)),
                ('fecha_creacion', models.DateTimeField(auto_now_add=True)),
                ('fecha_modificacion', models.DateTimeField(auto_now=True)),
                ('total_destinatarios', models.IntegerField(default=0)),
                ('total_enviados', models.IntegerField(default=0)),
                ('total_errores', models.IntegerField(default=0)),
                ('destinatarios_personalizados', models.ManyToManyField(blank=True, related_name='mensajes_recibidos', to='core.miembro')),
                ('lista_distribucion', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.listadistribucion')),
            ],
            options={
                'verbose_name': 'Mensaje',
                'verbose_name_plural': 'Mensajes',
                'db_table': 'Mensajes',
                'ordering': ['-fecha_creacion'],
            },
        ),
        migrations.CreateModel(
            name='PlantillaMensaje',
            fields=[
                ('id_plantilla', models.AutoField(primary_key=True, serialize=False)),
                ('nombre', models.CharField(max_length=100, unique=True)),
                ('descripcion', models.TextField(blank=True, null=True)),
                ('asunto', models.CharField(max_length=200)),
                ('contenido_html', models.TextField()),
                ('contenido_texto', models.TextField(blank=True, null=True)),
                ('tipo', models.CharField(choices=[('bienvenida', 'Bienvenida'), ('evento', 'Evento'), ('recordatorio', 'Recordatorio'), ('cumpleanos', 'Cumpleaños'), ('general', 'General'), ('emergencia', 'Emergencia')], default='general', max_length=50)),
                ('variables_disponibles', models.JSONField(default=list, help_text='Lista de variables que se pueden usar en la plantilla')),
                ('activa', models.BooleanField(default=True)),
                ('fecha_creacion', models.DateTimeField(auto_now_add=True)),
                ('creado_por', models.CharField(max_length=100)),
            ],
            options={
                'verbose_name': 'Plantilla de Mensaje',
                'verbose_name_plural': 'Plantillas de Mensajes',
                'db_table': 'Plantillas_Mensajes',
            },
        ),
        migrations.CreateModel(
            name='Notificacion',
            fields=[
                ('id_notificacion', models.AutoField(primary_key=True, serialize=False)),
                ('titulo', models.CharField(max_length=200)),
                ('mensaje', models.TextField()),
                ('tipo', models.CharField(choices=[('info', 'Información'), ('aviso', 'Aviso'), ('recordatorio', 'Recordatorio'), ('urgente', 'Urgente'), ('cumpleanos', 'Cumpleaños'), ('evento', 'Evento')], default='info', max_length=50)),
                ('leida', models.BooleanField(default=False)),
                ('fecha_lectura', models.DateTimeField(blank=True, null=True)),
                ('mostrar_hasta', models.DateTimeField(blank=True, help_text='Fecha hasta la cual mostrar la notificación', null=True)),
                ('requiere_accion', models.BooleanField(default=False)),
                ('url_accion', models.URLField(blank=True, null=True)),
                ('fecha_creacion', models.DateTimeField(auto_now_add=True)),
                ('creado_por', models.CharField(blank=True, max_length=100, null=True)),
                ('destinatario', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='notificaciones', to='core.miembro')),
            ],
            options={
                'verbose_name': 'Notificación',
                'verbose_name_plural': 'Notificaciones',
                'db_table': 'Notificaciones',
                'ordering': ['-fecha_creacion'],
            },
        ),
        migrations.CreateModel(
            name='SeguimientoEnvio',
            fields=[
                ('id_seguimiento', models.AutoField(primary_key=True, serialize=False)),
                ('estado', models.CharField(choices=[('pendiente', 'Pendiente'), ('enviado', 'Enviado'), ('entregado', 'Entregado'), ('leido', 'Leído'), ('error', 'Error'), ('rebotado', 'Rebotado')], default='pendiente', max_length=50)),
                ('email_destinatario', models.EmailField(max_length=254)),
                ('fecha_envio', models.DateTimeField(blank=True, null=True)),
                ('fecha_entrega', models.DateTimeField(blank=True, null=True)),
                ('fecha_lectura', models.DateTimeField(blank=True, null=True)),
                ('mensaje_error', models.TextField(blank=True, null=True)),
                ('intentos_envio', models.IntegerField(default=0)),
                ('token_seguimiento', models.CharField(blank=True, max_length=100, null=True, unique=True)),
                ('ip_lectura', models.GenericIPAddressField(blank=True, null=True)),
                ('user_agent', models.TextField(blank=True, null=True)),
                ('destinatario', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.miembro')),
                ('mensaje', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='seguimientos', to='core.mensaje')),
            ],
            options={
                'verbose_name': 'Seguimiento de Envío',
                'verbose_name_plural': 'Seguimiento de Envíos',
                'db_table': 'Seguimiento_Envios',
                'unique_together': {('mensaje', 'destinatario')},
            },
        ),
        migrations.CreateModel(
            name='MiembroListaDistribucion',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('fecha_agregado', models.DateTimeField(auto_now_add=True)),
                ('lista', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='miembros_personalizados', to='core.listadistribucion')),
                ('miembro', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.miembro')),
            ],
            options={
                'verbose_name': 'Miembro en Lista',
                'verbose_name_plural': 'Miembros en Listas',
                'db_table': 'Miembros_Listas_Distribucion',
                'unique_together': {('lista', 'miembro')},
            },
        ),
    ]
